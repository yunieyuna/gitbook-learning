# 4. Linear Algebra and Calculus for Deep Learning

## Chapter 4. Linear Algebra and Calculus for Deep Learning

Algebra and calculus are integral parts of data science. Machine learning and deep learning algorithms are mostly based on algebra and calculus techniques. This chapter introduces some key topics in a way that everyone can understand.

_Algebra_ is the study of operations and relational rules, as well as the constructions and ideas that result from them. Algebra covers topics such as linear equations and matrices. You can consider algebra as the first step towards calculus.

_Calculus_ is the study of curve slopes and rates of change. Calculus covers topics such as derivatives and integrals. It is heavily used in many fields such as economics and engineering. Many learning algorithms rely on the concepts of calculus to perform their complex operations.

The distinction between the two is that while calculus works with ideas of change, motion, and accumulation, algebra deals with mathematical symbols and the rules for manipulating those symbols. Calculus focuses on the characteristics and behavior of changing functions, while algebra offers the foundation for solving equations and comprehending functions.

## Linear Algebra

Algebra encompasses various mathematical structures, including numbers, variables, and operations like addition, subtraction, multiplication, and division. _Linear algebra_ is a fundamental branch of algebra that deals with vector spaces and linear transformations. It is heavily used in machine learning and deep learning for tasks such as data preprocessing, dimensionality reduction, and solving systems of linear equations. Matrices and vectors are central data structures in linear algebra, and operations like matrix multiplication are common in various algorithms.

### Vectors and Matrices

A _vector_ is an object that has a magnitude (length) and a direction (arrowhead). The basic representation of a vector is an arrow with coordinates on the axis. But first, let’s see what an axis is.

The _x_-axis and _y_-axis are perpendicular lines that specify a plane’s boundaries and the locations of different points within them in a two-dimensional Cartesian coordinate system. The _x_-axis is horizontal and the _y_-axis is vertical.

These axes may represent vectors, with the _x_-axis representing the vector’s horizontal component and the _y_-axis representing its vertical component.

**NOTE**

In time series analysis, the _x_-axis is typically the time step (hours, days, etc.) and the _y_-axis is the value at the respective time step (price, return, etc.).

[Figure 4-1](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-1) shows a simple two-dimensional Cartesian coordinate system with both axes.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0401.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-1. Two-dimensional Cartesian coordinate system**

The two-dimensional Cartesian coordinate system uses simple parentheses to show the location of different points following this order:

����������������=(�,�)�ℎ���������������������ℎ�ℎ������������������ℎ���������������������ℎ�����������������

Therefore, if you want to draw point A which has (2, 3) as coordinates, you are likely to look at a graph from point zero, move two points to the right and from there, move three points upwards. The result of the point should look like [Figure 4-2](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-2).

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0402.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-2. The location of A on the coordinate system**

Let’s now add another point and draw a vector between them. Suppose you have also point B with (4, 5) as coordinates. Naturally, as the coordinates of B are higher than the coordinates of A, you would expect vector AB to be upwards sloping. [Figure 4-3](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-3) shows the new point B and vector AB.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0403.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-3. Vector AB joining A and B points together in magnitude and direction**

However, having drawn the vector using the coordinates of both points, how would you refer to the vector? Simply put, vector AB has its own coordinates that represent it. Remember that the vector is a representation of the movement from point A to point B. This means the two-point movement along the _x_-axis and the _y_-axis is the vector. Mathematically, to find the vector, you should subtract the two coordinate points from each other while respecting the direction. Here’s how:

* _Vector AB_ means that you are going from A to B, therefore, you need to subtract the coordinates of point B from the coordinates of point A:

��→=<4-2,5-3>��→=<2,2>

* _Vector BA_ means that you are going from B to A, therefore, you need to subtract the coordinates of point A from the coordinates of point B:

��→=<2-4,3-5>��→=<-2,-2>

To interpret AB and BA vectors, you think in terms of movement. vector AB represents going from point A to point B, two positive points horizontally and vertically (right and upwards respectively). Vector BA represents going from point B to point A, two negative points horizontally and vertically (left and downwards respectively).

**NOTE**

Vectors AB and BA are not the same thing even though they share the same slope. But what is a slope anyway?

The _slope_ is the ratio of the vertical change between two points on the line to the horizontal change between the same two points. You calculate the slope using this mathematical formula:

�����=(��)(��)���������→=22=1���������→=-2-2=1

If the two vectors were simply lines (with no direction), then, they would be the same object. However, adding the directional component makes them two distinguishable mathematical objects.

[Figure 4-4](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-4) sheds more light on the concept of the slope, as _x_ has shifted two points to the right and _y_ has shifted two points to the left.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0404.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-4. The change in x and the change in y for vector AB**

[Figure 4-5](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-5) shows the change in _x_ and the change in _y_ in the case of vector BA.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0405.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-5. The change in x and the change in y for vector BA**

**NOTE**

A vector that has a magnitude of 1 is referred to as a _unit vector_.

Researchers typically use vectors as representations of speed especially in engineering. Navigation is one field that heavily relies on vectors. It allows navigators to determine their positions and plan their destinations. Naturally, magnitude represents speed and the direction represents the destination.

You can add and subtract vectors from each other and from scalars. This allows for a shift in direction and magnitude. What you should retain from the previous discussion is that vectors indicate directions between different points on the axis.

**NOTE**

A _scalar_ is a value with magnitude but no direction. Scalars, as opposed to vectors, are used to represent elements like temperature and prices. Basically, scalars are numbers.

A _matrix_ is a row-and-column-organized rectangular array containing numbers[1](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#id243). Matrices are useful in computer graphics and other domains as well as to define and manipulate linear systems of equations. What differentiates a matrix from a vector? The simplest answer is that a vector is a matrix with a single column or a single row. Here’s a a basic example of a 3 x 3 matrix:

529-810131512

Matrices’ sizes are referred to using their rows and columns respectively. A row is a horizontal line and a column is a vertical line. The following representation is a 2 x 4 matrix:

5213-81094

The following representation is another example of a matrix. This time it is a 4 x 2 matrix:

52-81082273

**NOTE**

Matrices are heavily used in machine learning. Rows generally represent time and columns represent features.

The summation of different matrices is straightforward but must be used only when the matrices match in size (which means they have the same number of columns and rows). For instance, let’s add the two following matrices:

1258+3915=411613

You can see that to add two matrices, you simply have to add the numbers in the same positions. Now, if you try to add the two following matrices, you won’t be able to do it as there is a mismatch in what to add:

8332+391554

The subtraction of matrices is also straighforward and follows the same rules as the summation of matrices. Let’s take the following example:

52-810-39-1-5=2-7-915

Evidently, subtraction of matrics is also a summation of matrices with a change of signs in one of them.

Matrix multiplication by a scalar is quite simple. Let’s take the following example:

3×52822=1562466

So basically, you are multiplying every cell in the matrix by the scalar. Matrix multiplication by another matrix is a bit more complicated since they use the _dot product_ method. First of all, in order to multiply two matrices together, they must satisfy this condition:

��������×��������=��������

This means that the first matrix must have a number of columns equal to the number of rows in the second matrix, and the resulting matrix from the dot product is a matrix that has the number of rows of the first matrix and the number of columns of the second matrix. The dot product is explained in this example representation of a 1 x 3 and 3 x 1 matrix multiplication (notice the equal number of columns and rows):

123×321=(1×3)+(2×2)+(3×1)=10

Let’s take another example of a 2 x 2 matrix multiplication:

1201×3021=7221

There is a special type of matrix called the _identity matrix_ which is basically the number 1 for matrices. It is defined as follows for a 2 x 2 dimension:

�=1001

And as follows for a 3 x 3 dimension:

�=100010001

Multiplying any matrix by the identity matrix yields the same original matrix. This is why it can be referred to as the 1 of matrices (multiplying any number by 1 yields the same number). It is worth noting that matrix multplication is not commutative, which means that the order of multiplication changes the result such as:

��≠��

_Matrix transposing_ is a process that involves changing the rows of into columns and vice versa. The transpose of a matrix is obtained by reflecting the matrix along its main diagonal:

461142�=416412

Transposing is used in some machine learning algorithms and is not an uncommon operation when dealing with such models. If you are wondering about the role of matrices in data science and machine learning, you can refer to this non-exhaustive list:

Representation of dataMatrices often represent data with rows representing samples and columns representing features. For example, a row in a matrix can present OHLC data in one time step.Linear algebraMatrices and linear algebra are intertwined, and many learning algorithms use the concepts of matrices in their operations. Having a basic understanding of these mathematical concepts helps smooth the learning curve when dealing with machine learning algorithms.Data relationship matricesCovariance and correlation measures are often represented as matrices. These relationship calculations are important concepts in time series analysis.

**NOTE**

The key takeaways from this section are as follows:

* A vector is an object that has a magnitude (length) and a direction (arrowhead). Multiple vectors grouped together form a matrix.
* A matrix can be used to store data. It has its special ways of performing operations.
* Matrix multiplication uses the dot product method.&#x20;
* Transposing a matrix means to swap its rows and its columns.

### Introduction to Linear Equations

You have already seen an example of a linear equation in the section that discusses linear regression and statistical inference from [Chapter 3](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch03.html#ch03). _Linear equations_ are basically formulae that present an equality relationship between between different variables and constants. In the case of machine learning, it is often a relationship between a dependent variable (the output) and the independent variable (the input). The best way to understand linear equations is through examples.​

**NOTE**

The aim of linear equations is to find an unknown variable, usually denoted by the letter _x_.

Let’s see a very basic example which you can consider as a first building block towards more advanced concepts you will see later on. The following example requires finding the value of _x_ that satisfies the equation:

10�=20

You should understand the equation as "_10 times which number equals 20?”_. When a constant is directly attached to a variable such as _x_, it refers to a multiplication operation. Now, to solve for _x_ (so, finding the value of _x_ that equalizes the equation), you have an obvious solution which is to get rid of 10 so that you have _x_ on one side of the equation and the rest on the other side.

Naturally, to get rid of 10, you divide by 10 so that what remains is 1 which if multiplied by the variable _x_ does nothing. However, keep in mind two important things:

* If you do a mathematical operation on one side of an equation, you must do it on the other side as well. This is why they are called equations.
* For simplicity, instead of dividing by the constant to get rid of it, you should multiply it by its reciprocal.

The _reciprocal_ of a number is one divided by that number. Here’s the mathematical representation of it:

����������(�)=1�

Now, back to the example, to find _x_, you can do the following:

(110)10�=20(110)

Performing the multiplication and simplifying gives the following result:

�=2

This means that the solution of the equation is 2. To verify this, you just need to plug it into the original equation as follows:

10×2=20

Therefore, it takes two 10’s to get 20.

**NOTE**

Dividing the number by itself or multiplying it by its reciprocal is the same thing.

Let’s take another example of how to solve _x_ through linear techniques. Consider the following problem:

86�=24

Performing the multiplication and simplifying gives the following result:

(68)86�=24(68)

�=18

This means that the solution of the equation is 18. To verify this, you just need to plug it into the original equation as follows:

86×18=24

Typically, linear equations are not this simple. Sometimes they contain more variables and more constants, which need more detailed solutions, but let’s keep taking it step by step. Consider the following example:

3�-6=12

Solving for _x_ requires rearranging the equation a little bit. Remember, the aim is to leave _x_ on one side and the rest on the other. Here, you have to get rid of the constant 6 before taking care of 3. The first part of the solution is as follows:

3�-6(+6)=12(+6)

Notice how you have to add 6 to both parts of the equation. The part on the left will cancel itself out while the part on the right will add up to 18:

3�=18

Finally, you’re all set to multiply by the reciprocal of the constant attached to the variable _x_:

(13)3�=18(13)

Simplifying and solving for _x_ leaves the following solution:

�=6

This means that the solution of the equation is 6. To verify this, just plug it into the original equation as follows:

(3×6)-6=12

By now, you should start noticing that linear algebra is all about using shortcuts and quick techniques to simplify equations and find unknown variables. The next example shows how sometimes the variable _x_ can occur in multiple places:

6�+�=27-2�

Remember, the main focus is to have _x_ on one side of the equation and the rest on the other side:

6�+�+2�=27

Adding the constants of _x_ gives you the following:

9�=27

The final step is dividing by 9 so that you only have _x_ remaining:

�=3

You may now verify this by plugging 3 in the place of _x_ in the original equation. You will notice that both sides of the equation will be equal.

**NOTE**

Even though this section is quite simple, it contains the basic foundations you need to start advancing in algebra and calculus. The key takeaways from this section are as follows:

* A linear equation is a representation in which the highest exponent on any variable is one. This means that there are no variables that are raised to the power of two and above.&#x20;
* A linear equation line is straight when plotted on a chart.
* The application of linear equations in modeling a wide range of real-world occurrences makes them crucial in many branches of mathematics and research. They are also widely utilized in machine learning.
* Solving for _x_ is the process of finding its value that equalizes both sides of the equation.
* When performing an operation (such as adding a constant or multiplying by a constant) on one side of the equation, you have to do it on the other side as well.

### Systems of Equations

A _system of equation_ is when there are two or more equations working together to solve a variable or more. Therefore, instead of the usual single equation like the following:

�+10=20

Systems of equations resemble the following:

�+10=20

�+2�=10

Systems of equations are useful in machine learning and are used in many of its aspects.

Let’s look at the previous system of equation from the beginning of this section and solve it graphically. Plotting the two functions can actually give the solution directly. The point of intersection is the solution. Therefore, the coordinates of the intersection (_x, y_) refer to the solutions of the _x_ and _y_ respectively.

From [Figure 4-6](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-6), it seems that _x_ = 10 and _y_ = -10. Plugging these values into their respective variables gives the correct answer:

10+10=20

(-10)+(2×10)=10

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0406.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-6. A graph showing the two functions and their intersection (solution)**

As the functions are linear, there can be three cases to solving them:

1. There is only one solution for each variable.
2. There is no solution. This occurs when the functions are _parallel_ (this means that they never intersect).
3. The is an infinite number of solutions. This occurs when it’s the same function (since all points fall on the straight line).

Before moving on to solving systems of equations using algebra, let’s visually see how can there be no solution and how can there be an infinite number of solutions. Consider the following system:

2�=10

4�=20

[Figure 4-7](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-7) charts the two together. Since they are exactly the same equation, they fall on the same line. In reality, there are two lines in [Figure 4-7](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-7), but since they are the same, they are indistinguishable. For every _x_ on the line, there is a corresponding _y_.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0407.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-7. A graph showing the two functions and their infinite intersections**

Now, consider the following system:

3�=10

6�=10

[Figure 4-8](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-8) shows how they never intersect, which is intuitive as you cannot multiply the same number (represented by the variable _x_) with different numbers and expect to get the same result.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0408.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-8. A graph showing the two functions and their impossible intersection**

Algebraic methods are used when there are more than two variables since they cannot be solved through graphs. This mainly entails two methods, substitution and elimination.

_Substitution_ is used when you can replace the value of a variable in one equation and plug it in the second equation. Consider the following example:

�+�=2

10�+�=10

The easiest method is to rearrange the first equation so that you have _y_ in terms of _x_:

�=2-�

10�+(2-�)=10

Solving for _x_ in the second equation becomes simple:

10�+(2-�)=1010�+2-�=1010�-�=10-29�=8�=89�=0.8889

Now that you have found the value of _x_, you can easily find _y_ by plugging the value of _x_ in the first equation:

0.8889+�=2�=2-0.8889�=1.111

To check if your solution is correct, you can plug in the values of _x_ and y in both formulas:

0.8889+1.111=2(10×0.8889)+1.111=10

Graphically this means that the two equations intersect at (0.8889, 1.111). This technique can be used with more than two variables. Follow the same process until the equations are simplified enough to give you the answers. The issue with substitution is that it may take some time when you’re dealing with more than two variables.

_Elimination_ is a faster alternative. It is about eliminating variables until there is only one left. Consider the following example:

2�+4�=203�+2�=10

Noticing that there is 4_y_ and 2_y_, it is possible to multiply the second equation by 2 so that you can subtract the equations from each other (which will remove the _y_ variable):

2�+4�=206�+4�=20

Subtracting the two equations from each other gives the following result:

\-4�=0�=0

Therefore, _x_ = 0. Graphically, this means that they intersect whenever _x_ = 0 (exactly at the vertical _y_ line). Plugging in the value of _x_ in the first formula gives _y_  = 5:

(2×0)+4�=204�=20�=5

Similarly, elimination can also solve equations with three variables. The choice between substitution and elimination depends on the type of equations.

**NOTE**

The key takeaways from this section are as follows:

* Systems of equations solve variables together. They are very useful in machine learning and are used in some algorithms.
* Graphical solutions are preferred for simple systems of equations.
* Solving systems of equations through algebra entails the use of substitution and elimination methods.
* Substitution is preferred when the system is simple but elimination is the way to go when the system is a bit more complex.

### Trigonometry

_Trigonometry e_xplores the behavior of what is known as _trigonometric functions_ that relate the angles of a triangle to the lengths of its sides. The most-used triangle is the right-angled triangle which has one angle at 90°. [Figure 4-9](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-9) shows an example of a right-angled triangle.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0409.png" alt="" height="370" width="520"><figcaption></figcaption></figure>

**Figure 4-9. A right-angled triangle**

Let’s define the main characteristics of a right-angled triangle:

* The longest side of the triangle is called a _hypotenuse._
* The angle in front of the hypotenuse is the right angle (the one at 90°).
* Depending on the other angle (θ) you choose (from the two that remains), the line between this angle and the hypotenuse is called the _adjacent_ and the other line is called the _opposite_.

**NOTE**

Trigonometric functions are mathematical functions used to relate the angles of a right triangle to the ratios of its sides. They have various applications in fields like geometry, physics, engineering, and more. They help analyze and solve problems related to angles, distances, oscillations, and waveforms, among other things.

Trigonometric functions are simply the division of a line by the other. Remember that you have three lines in a triangle (hypotenuse, opposite, and adjacent). The trigonometric functions are found as follow:

���(�)=������������������

���(�)=������������������

���(�)=����������������

From the previous three trigonometric functions, it is possible to extract a trigonometric identity which reaches _tan_ from _sin_ and _cos_ using basic linear algebra:

���(�)=���(�)���(�)

_Hyperbolic functions_ are similar to trigonometric functions but are defined using exponential functions. Before understanding hyperbolic functions, one must understand Euler’s number.

**NOTE**

This part on hyperbolic functions is interesting as it forms the basis of what is known as _activation functions_, a key concept in neural networks, the protagonists of deep learning models. You will see them in detail in [Chapter 8](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch08.html#ch08).

_Euler’s number_ (denoted as _e_) is one of the most important numbers in mathematics. It is an _irrational number_, which is a real number that cannot be expressed as a fraction. The word _irrational_ comes from the fact that there is no _ratio_ to express it; it has nothing to do with its personality. Euler’s number is also the base of the natural logarithm _ln_ and the first digits of it are 2.71828. One of the best approximations to get _e_ is the following formula:

�=(1+1�)�

By increasing _n_ in the previous formula, you will approach the value of _e_. It has many interesting properties, notably the fact that its slope is its own value. Let’s take for example the following function (also called the natural exponent function):

�(�)=��

At any point, the slope of the function is the same value. Take a look at [Figure 4-10](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-10).

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0410.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-10. The graph of the natural exponent function**

**NOTE**

You may be wondering about the use of explaining exponents and logarithms in this book. There are mainly two reasons for this:

* Exponents and more importantly Euler’s number are used in hyperbolic functions where _tanh(x)_ is one of the main activation functions for neural networks, a type of machine and deep learning model.
* Logarithms are useful in _loss functions_, a concept that you will see in later chapters.

Hyperbolic functions use the natural exponent function and are defined as follows:

���ℎ(�)=��-�-�2

���ℎ(�)=��+�-�2

���ℎ(�)=��-�-���+�-�

Among the key characteristics of _tanh(x)_ is non-linearity, the limitation between \[-1, 1], and the fact that it is centered at zero. [Figure 4-11](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-11) shows the graph of _tanh(x)_.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0411.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-11. The graph of tanh(x) showing how it’s limited between -1 and 1**

**NOTE**

The key takeaways from this section are as follows:

* Trigonometry is a field that explores the behavior of trigonometric functions which relate the angles of a triangle to the lengths of its sides.
* A trigonometric identity is a shortcut that relates the trigonometric functions with each other.
* Euler’s number _e_ is irrational and is the base of the natural logarithm. It has many applications in exponential growth and in hyperbolic functions.&#x20;
* The hyperbolic tangent function is used in neural networks, a deep learning algorithm.&#x20;

## Calculus

As previously mentioned, calculus is a branch of mathematics that focuses on the study of rates of change and accumulation of quantities. It consists of two primary branches: _differential calculus_ (that deals with derivatives) and _integral calculus_ (that deals with integration). This section briefly introduces both types of calculus while also discussing topics such as limits and optimization.

### Limits and Continuity

> Calculus works by making visible the infinitesimally small.
>
> \- Keith Devlin

Limits don’t have to be nightmarish. I have always found them to be misunderstood. They are actually quite easy to get. But first, you need motivation and this comes from knowing the added value of learning limits.

Understanding limits is important in machine learning models for many reasons:

OptimizationIn optimization methods like gradient descent, limits can be used to regulate the step size and guarantee convergence to a local minimum.Feature SelectionLimits can be used to rank the significance of various model features and perform feature selection, which can make the model simpler and perform better.Sensitivity analysisA machine learning model’s sensitivity to changes in input data and its capacity to generalize to new data can be used to examine a model’s behavior.

​Also, limits are used in more advanced calculus concepts you will run across in the coming pages.

The main aim of limits is to know the value of a function when it’s undefined. But what is an _undefined function_? When you have a function that gives a solution that is not possible (such as dividing by zero), limits help you bypass this issue in order to know the value of the function at that point. So the aim of limits is to solve functions even when they are undefined.

Remember that the solution to a function that takes _x_ as an input is a value in the _y_ axis. [Figure 4-12](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-12) shows a linear graph of the following function:

�(�)=�+2

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0412.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-12. The graph of the function f(x) = x + 2**

The solution of the function in the graph is the one that lies on the linear line taking into account the value of _x_ every time.

What would be the solution of the function (the value of _y_) when _x_ = 4? Clearly, the answer is 6, as substituting the value of _x_ by 4 gives 6.

�(4)=4+2=6

Thinking of this solution in terms of limits would be saying, what is the solution of the function as _x_ approaches 4 from both sides (the negative/decreasing side and the positive/increasing side)? [Table 4-1](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#table-4-1) simplifies this dilemma:

| _f(x)_ | _x_   |
| ------ | ----- |
| 5.998  | 3.998 |
| 5.999  | 3.999 |
| 6.000  | 4     |
| 6.001  | 4.001 |
| 6.002  | 4.002 |

Approaching from the negative side is the equivalent of adding a fraction of a number while below 4 and analyzing the result every time. Similarly, approaching from the positive side is the equivalent of removing a fraction of a number while above 4 and analyzing the result every time. The solution seems to converge to 6 as _x_ approaches 4. This is the solution to the limit.

Limits in the general form are written following this convention:

lim�→��(�)=�

The general form of the limit is read as follows: as you approach _a_ along the _x_-axis (whether from the positive or the negative side), the function _f(x)_ gets closer to the value of _L_.

**NOTE**

The idea of the limit states that as you lock-in and approach a number from either side (negative or positive), the solution of the equation approaches a certain number, and the solution to the limit is that number.

As mentioned previously, limits are useful when the exact point of the solution is undefined using the conventional way of substitution.

A one-sided limit is different from the general limit. The left-hand limit is where you search for the limit going from the negative side to the positive side, and the right-hand limit is when you search for the limit going from the positive side to the negative side. The general limit exists when the two one-sided limits exist and are equal. Therefore, the previous statements are summarized as follows:

* The left-hand limit exists.
* The right-hand limit exists.
* The left-hand limit is equal to the right-hand limit.

The left hand limit is defined as follows:

lim�→�-�(�)=�

The right hand limit is defined as follows:

lim�→�+�(�)=�

Let’s take the following equation:

�(�)=�3-27�-3

What is the solution of the function when x = 3? Substitution leads to the following issue:

�(3)=33-273-3=27-273-3=00=���������

However, thinking about this in terms of limits as [Table 4-2](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#table-4-2) shows, it seems that as you approach _x = 3_, either from the left side or the right side, the solution tends to approach 27.

| f(x)   | x         |
| ------ | --------- |
| 2.9998 | 26.9982   |
| 2.9999 | 26.9991   |
| 3.0000 | Undefined |
| 3.0001 | 27.0009   |
| 3.0002 | 27.0018   |

Graph-wise, this can be seen as a discontinuity in the chart along both axes. The discontinuity exists on the line around the coordinate (3, 27).

Some functions do not have limits. For example, what is the limit of the following function as _x_ approaches 5?

lim�→51�-5

Looking at [Table 4-3](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#table-4-3), it seems that as _x_ approaches 5, the results highly diverge when approaching from both sides. For instance, approaching from the negative side, the limit of 4.9999 is -10,000 and from the positive side, the limit of 5.0001 is 10,000.

| f(x)   | x         |
| ------ | --------- |
| 4.9998 | -5000     |
| 4.9999 | -10000    |
| 5.0000 | Undefined |
| 5.0001 | 10000     |
| 5.0002 | 5000      |

Remember that for the general limit to exist, both one-sided limits must exist and must be equal, which is not the case here. Graphing this gives [Figure 4-13](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-13), which may help you understand why the limit does not exist.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0413.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-13. The graph of the function proving that the limit does not exist**

But what if the function that you want to analyze looks like this:

lim�→51|�-5|

Looking at [Table 4-3](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#table-4-3), it seems that as _x_ approaches 5, the results rapidly accelerate as they diverge to a certain very big number referred to as infinity (∞). Take a look at [Table 4-4](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#table-4-4):

�(�)=1|�-5|

| f(x)      | x         |
| --------- | --------- |
| 4.99997   | 33333.33  |
| 4.99998   | 50000     |
| 4.99999   | 100000    |
| 4.9999999 | 10000000  |
| 5         | Undefined |
| 5.0000001 | 10000000  |
| 5.00001   | 100000    |
| 5.00002   | 50000     |
| 5.00003   | 33333.33  |

See how at every tiny step _x_ approaches 5, _y_ approaches positive infinity. The answer to the limit question is therefore, positive infinity (+∞). [Figure 4-14](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-14) shows the graph of the function. Notice how they both rise in value as _x_ approaches 5.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0414.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-14. The graph of the function proving that the limit exists as x approaches 5**

## TO INFINITY AND BEYOND

In this optional note, you can understand what infinity represents in terms of mathematics. _Infinity_ is an idea or a concept rather than a number. The symbol (∞) is often referred to as a _lemniscate_.

Positive infinity (∞) and negative infinity (-∞) are both concepts that exist across the axis where the former tends towards the right and the latter tends towards the left.

Interestingly, infinity is often thought of as an ever-growing measure, but it is not expanding or getting bigger. It is already what it is.

Mathematical operations including the concept of infinity may be hard to grasp and have many considerations. One of the most interesting examples is the answer to why the result of 1 divided by zero is undefined.

Imagine dividing an apple by ten people; normally every person will get an equal fraction (1/10) of that apple until the apple is consumed. But what if you want to divide the apple by zero people? The number of people required to consume the apple will tend towards infinity (the logic is hard to grasp, but mathematically you can think of infinitesimally small parts of the apple requiring a huge number of people to consume them).

Therefore, following this logic, you can say that 1 divided by 0 is infinity and is actually defined. So, why is it generally considered as undefined? The issue is that the infinity described in the apples’ example is the positive one, and if you want to follow the example of dividing 1 by infinitesimally small negative numbers that tend towards zero, then you will also say that 1 divided by 0 is negative infinity.

So which is it? Positive or negative infinity? Because of this conflict, the result is undefined.

_Continuous_ functions are ones that are drawn without gaps or holes in the graph, while _discontinuous_ functions contain such gaps and holes. This usually means that the latter contain points where the solution of the functions is undefined and may need to be approximated by limits. Therefore, continuity and limits are two related concepts.

Let’s proceed to solving limits; after all, you are not going to create a table every time and analyze the results subjectively to find the limits. There are three ways to solve limits:

* _Substitution_: This is the simplest rule and is generally used first.
* _Factoring_: This comes after substitution does not work.
* _Conjugate methods_: This solution comes after the first two ways do not work.

The _substitution_ way is simply plugging in the value which _x_ approaches. Basically, these are functions that have solutions where the limits are used. Take the following example:

lim�→5�+10-2�

Using the substitution way, the limit of the function is found as follows:

lim�→5�+10-2�=5+10-(2×5)=5

Therefore, the answer to the limit is 5.

The _factoring_ way is the next option when substitution does not work (for example, the limit is undefined after plugging in the value of _x_ in the function). _Factoring_ is all about changing the form of the equation using factors in a way that it is not undefined anymore when using the substitution way. Take the following example:

lim�→-6(�+6)(�2-�+1)�+6

If you try the substitution way, you will get an undefined value as follows:

lim�→-6(�+6)(�2-�+1)�+6=(-6+6)((-6)2-(-6)+1)-6+6=00=���������

Factoring may help in this case. For example, the nominator is multiplied by (_x_ + 6) and then divided by (_x_ + 6). Simplifying this by canceling the two terms could give a solution:

lim�→-6(�+6)(�2-�+1)�+6=lim�→-6�2-�+1

Now that factoring is done, you can try substitution once again:

lim�→-6�2-�+1=(-6)2-(-6)+1=43

The limit of the function as _x_ tends towards -6 is therefore 43.

The _conjugate_ way is the next option in case substitution and factoring do not work. A conjugate is simply the changing of signs between two variables. For example, the conjugate of _x_ + _y_ is  _x_ - _y_. The way to do this in the case of a fraction is to multiply the nominator and the denominator by the conjugate of one of them (with a preference to use the conjugate of the term that has a square root since it will get canceled out). Take the following example:

lim�→9�-9�-3

By multiplying both terms by the conjugate of the denominator, you will have started to use the conjugate way to solve the problem:

lim�→9�-9�-3(�+3�+3)

Taking into account the multiplication and simplifying gives the following:

lim�→9(�-9)(�+3)(�-3)(�+3)

You will be left with the following familiar situation:

lim�→9(�-9)(�+3)�-9

lim�→9�+3

Now, the function is ready for substitution:

lim�→99+3=3+3=6

The solution to the function is therefore 6. As you can see, sometimes work needs to be done on preparing the equations in order to be ready for substitution.

**NOTE**

The key takeaways from this section are as follows:

* Limits help find solutions for functions that may be undefined in certain points.
* For the general limit to exist, the two one-sided limits must exist and must be equal.
* There are ways to find the limit of a function, notably substitution, factoring, and the conjugate way.

### Derivatives

A _derivative_ measures the change in a function given a change of one or more of its inputs. In other words, it is the rate of change of a function at a given point.

Having a solid understanding of derivatives is important in building machine learning models for multiple reasons:

OptimizationIn order to minimize the loss function, optimization methods employ derivatives to ascertain the direction of the steepest descent and modify the model’s parameters.BackpropagationTo execute gradient descent in deep learning, the backpropagation technique uses derivatives to calculate the gradients of the loss function with respect to the model’s parameters.Hyperparameter tuningTo improve the performance of the model, derivatives are used for sensitivity analysis and tuning of hyperparameters.

Do not forget what you have learned from the previous section on limits, as you will be needing them for this section as well. Calculus mainly deals with derivatives and integrals. This section discusses derivatives and their uses.

You can consider derivatives as functions that represent (or model) the slope of another function at some point. A _slope_ is a measure of a line’s position relative to a horizontal line. A positive slope indicates a line moving up, while a negative slope indicates a line moving down.

Derivatives and slopes are related concepts, but they are not the same thing. Here’s the main difference between the two:

* The slope measures the steepness of a line. It is the ratio of the change in the _y_-axis to the change in the _x_-axis.
* The derivative describes the rate of change of a given function. As the distance between two points on a function approaches zero, the derivative of that function at that point is the limit of the slope of the tangent line.

Before explaining derivatives in layperson’s terms and seeing some examples, let’s see their formal definitions:

�'(�)=limℎ→0�(�+ℎ)-�(�)ℎ

The equation forms the basis of solving derivatives, although there are many shortcuts that you will learn about. Let’s try finding the derivative of a function using the formal definition. Consider the following equation:

�(�)=�2+4�-2

To find the derivative, plug _f(x)_ inside the formal definition and then solve the limit:

�'(�)=limℎ→0�(�+ℎ)-�(�)ℎ

To simplify things, let’s find _f(x + h)_ so that plugging it in the formal definition becomes easier:

�(�+ℎ)=(�+ℎ)2+4(�+ℎ)-2

�(�+ℎ)=�2+2�ℎ+ℎ2+4�+4ℎ-2

Now, let’s plug _f(x + h)_ into the definition:

�'(�)=limℎ→0�2+2�ℎ+ℎ2+4�+4ℎ-2-�2-4�+2ℎ

Notice how there are many terms that can be simplified so that the formula becomes clearer. Remember, you are trying to find the limit for the moment, and the derivative is found after solving the limit:

�'(�)=limℎ→02�ℎ+ℎ2+4ℎℎ

The division by _h_ gives further potential for simplification since you can divide all the terms in the numerator by the denominator _h_:

�'(�)=limℎ→02�+ℎ+4

It’s now time to solve the limit. Because the equation is simple, the first attempt is by substitution, which is, as you have guessed, possible. By substituting the variable _h_ and making it zero (according to the limit), you are left with the following:

�'(�)=2�+4

That is the derivative of the original function _f(x)_. If you want to find the derivative of the function when _x_ = 2, you simply have to plug it in to the derivative function:

�'(2)=2(2)+4=8

Take a look at the graph of the function that you have just solved. [Figure 4-15](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-15) shows the original function’s graph with the derivative (the straight line). Notice how _f'(2)_ lies exactly at 8. The slope of _f(x)_ when _x_ = 2 is 8.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0415.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-15. The original f(x) with its derivative f'(x)**

**NOTE**

Notice that when _f(x)_ hits the bottom and starts rising, _f'(x)_ crossed the zero line.

You are unlikely to use the formal definition every time you want to find a derivative. There are derivative rules that allow you to save a lot of time through shortcuts. The first rule is referred to as the _power rule,_ which is a way to find the derivative of functions with exponents.

It is common to also refer to derivatives using this notation (which is the same thing as _f'(x)_):

����

The power rule for finding derivatives is as follows:

����(���)=(�.�)��-1

Basically, what this means is that the derivative is found by multiplying the constant by the exponent and then subtracting 1 from the exponent. Here’s an example:

�(�)=�4

�'(�)=(1×4)�(4-1)=4�3

Remember that if there is no constant attached to the variable, it means that the constant is equal to 1. Here’s a more complex example with the same principle:

�(�)=2�2+3�7-2�3

�'(�)=4�+21�6-6�2

It is worth noting that the rule also applies to constants even though they do not satisfy the general form of the power rule. The derivative of a constant is zero. However, it helps to know why, but first, you must be aware of this mathematical concept:

�0=1

With this being said, you can imagine constants as always being multiplied by _x_ to the power of zero (since it does not change their value). Now, if you want to find the derivative of 17, here’s how it would go:

17=17�0=(0×17)�0-1=0�-1=0

As you know, anything multiplied by zero returns zero as a result. This gives the constants rule for derivatives as follows:

����(�)=0

You follow the same logic when encountering fractions or negative numbers in the exponents.

The _product rule_ of derivatives is useful when there are two functions multiplied by each other. The product rule is as follows:

����\[�(�)�(�)]=�'(�)�(�)+�(�)�'(�)

Let’s take an example and find the derivative using the product rule:

ℎ(�)=(�2+2)(�3+1)

The equation can clearly by segmented into two terms, _f(x)_ and _g(x),_ like this:

�(�)=(�2+2)

�(�)=(�3+1)

Let’s find the derivatives of the two terms before applying the product rule. Notice that finding the derivative of _f(x)_ and _g(x)_ is easy once you have understood the power rule:

�'(�)=2�

�'(�)=3�2

When applying the product rule, you should get the following:

ℎ'(�)=(�2+2)(3�2)+(2�)(�3+1)

ℎ'(�)=3�4+6�2+2�4+2�

ℎ'(�)=5�4+6�2+2�

[Figure 4-16](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-16) shows the graph of _h(x)_ and _h'(x)_.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0416.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-16. The original h(x) with its derivative h'(x)**

The next step is to see the _quotient rule,_ which deals with the division of two functions. The formal definition is as follows:

����\[�(�)�(�)]=�'(�)�(�)-�(�)�'(�)\[�(�)]2

Let’s apply it into the following function:

�(�)=�2-�+1�2+1

As usual, it’s better to start by finding the derivatives of _f(x)_ and _g(x)_ which in this case are clearly separated, with _f(x)_ being the nominator and _g(x)_ being the denominator. When applying the quotient rule, you should get the following:

�'(�)=(2�-1)(�2+1)-(�2-�+1)(2�)(�2+1)2

�'(�)=2�3+2�-�2-1-2�3+2�2-2�(�2+1)2

�'(�)=�2-1(�2+1)2

_Exponential derivatives_ deal with the power rule applied to constants. Take a look at the following equation -- how would you find its derivative?

�(�)=��

Instead of the usual variable-base-constant-exponent, it is constant-base-variable-exponent. This is treated differently when trying to calculate the derivative. The formal definition is as follow:

������=��(ln�)

The following example shows how this is done:

����4�=4�(ln4)

Euler’s number, mentioned earlier, has a special derivative. When it comes to finding the derivative of _e_, the answer is interesting:

������=��(ln�)=��

This is because the natural log function and the exponential function are inverses of one another, so, the term _ln e_ equals to 1. Therefore, the derivative of the exponential function function _e_ is itself.

In parallel, let’s discuss logarithmic derivatives. By now, you should have known what exponents and logarithms are. The general definition for both types of logarithms is as follows:

����log��=1�ln�

����ln�=log��=1�ln�=1�

Notice how in the second derivative function of the natural logarithm, the term _ln e_ is once again encountered, thus making simplification quite easy since it is equal to 1.

Take the following example:

�(�)=7���2(�)

Using the formal definition, the derivative of this logarithmic function is as follows:

�'(�)=7(1�ln2)=7�ln2

**NOTE**

The logarithm _log_ has a base of 10, but the natural logarithm _ln_ has a base of _e_ (\~2.7182)

The natural logarithm and the log function are actually linearly related through simple multiplication. If you know the log of the constant _a_, you can find its natural logarithm _ln_ by multiplying the log of _a_ by 2.303.

One major concept in derivatives is the _chain rule_. Let’s back up to the power rule, which deals with exponents on variables. Remember the following formula to find the derivative:

����(���)=(�.�)��-1

This is a simplified version because there is only _x_, but the reality is that you must multiply by the derivative of the term under the exponent. Until now, you have seen only _x_ as the variable under the exponent. The derivative of _x_ is 1, which is why it is simplified and rendered invisible. However, with more complex functions such as this one:

�(�)=(4�+1)2

The derivative of the function is found by following these two steps:

1. Find the derivative of the outside function without touching the inside function.
2. Find the derivative of the inside function and multiply it by the rest of the function.

The solution is therefore as follows (knowing that the derivative of _4x + 1_ is just 4):

�'(�)=2(4�+1).4

�'(�)=8(4�+1)

�'(�)=32�+8

The same applies with the exponential functions. Take the following example:

�(�)=��

�'(�)=��(1)=��

The chain rule can actually be considered as a master rule as it applies anywhere even in the product rule and the quotient rule.

There are more concepts to master in derivatives, but as this book is not meant to be a full calculus masterclass, you should at least know the meaning of a derivative, how it is found, what does it represent, and how can it be used in machine and deep learning.

**NOTE**

The key takeaways from this section are as follows:

* A derivative measures the change in a function given a change of one or more of its inputs.
* The power rule is used to find the derivative of a function raised to a power.
* The product rule is used to find the derivative of two functions that are multiplied together.
* The quotient rule is used to find the derivative of two functions that are divided by each other.
* The chain rule is the master rule used in differentiating (which means the process of finding the derivative). Due to simplicity, it is often overlooked.
* Derivatives play a crucial role in machine learning such as enabling optimization techniques, aiding model training, and enhancing the interpretability of the models.

### Integrals and the Fundamental Theorem of Calculus

An _integral_ is an operation that represents the area under a curve of a function given an interval. It is the inverse of a derivative, which is why it is also called an _anti-derivative_.

The process of finding integrals is called _integration_. Integrals can be used to find areas below a curve and they are also heavily used in the world of finance such as risk management, portfolio management, probabilistic methods, and even option pricing.

The most basic way of understanding an integral is by thinking of calculating an area below the curve of a function. This can also be done by manually, calculating different changes in the _x_-axis, but it won’t be accurate (accuracy increases as you add up much smaller slices). Therefore, as the size of the slices approaches zero, the accuracy of the area gets better. Since this is a tedious process, integrals are here for the rescue.

Keep in mind that an integral is the inverse of a derivative. This is important because it implies a direct relationship between the two. The basic definition of an integral is as follows:

∫�(�)��=�(�)+�

�ℎ�∫�����������������ℎ�������������������

�(�)���ℎ��������������ℎ�����������������(�)

������������ℎ����������������ℎ�����������������������

������������������������������������ℎ������

What the preceding equation means is that the integral of _f(x)_ is the general function _F(x)_ plus a constant _C_ which was lost initially in the initial differentiation process. Here’s an example to better explain the need to put in the constant:

Consider the following function:

�(�)=�2+5

Calculating its derivative, you get the following result:

�'(�)=2�

Now, what if you wanted to integrate it so that you go back to the original function (which in this case is represented by the capital letter _F(x)_ instead of _f(x)_)?

∫2���

Normally, having seen the differentiation process (which means taking the derivative), you would return 2 as the exponent, which gives you the following answer:

∫2���=�2

This does not look like the original function. It’s missing the constant 5. But you have no way of knowing that or even if you knew there was a constant, what is it? 1? 2? 677? This is why a constant _C_ is added in the integration process so that it represents the lost constant. Therefore, the answer to the integration problem is as follows:

∫2���=�2+�

**NOTE**

Up until now, the discussion has been limited to _indefinite integrals_ where the integration symbol is _naked_ (which means there are no boundaries to it). You will see what this means right after defining the necessary rules to complete the integration.

For the power function (just like the previous function), the general rule for integration is as follows:

∫����=��+1�+1+�

This is much simpler than it looks. You are simply reversing the power rule you saw earlier. Consider the following example:

∫2�6��

∫2�6��=2�77+�

∫2�6��=27�7+�

To verify your answer, you can find the derivative of the result (using the power rule):

�(�)=27�7+�

�'(�)=(7)27�7-1+0

�'(�)=2�6

Let’s take another example. Consider the following integration problem:

∫2��

Naturally, using the rule, you should find the following result:

∫2��=2�+�

Let’s move on to _definite integrals,_ which are integrals with numbers on top and bottom that represent intervals below a curve of a function. Hence, _indefinite_ integrals find the area under the curve everywhere but definite integrals are bounded within an interval given by point _a_ and point _b_. The general definition of indefinite integrals is as follows:

∫���(�)��=�(�)-�(�)

This is as simple as it gets. You will solve the integral, then plug in the two numbers and subtract the two functions from each other. Consider the following evaluation of an integral (integral solving is commonly referred to as _evaluating_ the integral):

∫063�2-10�+4��

The first step is to understand what is being asked. From the definition of integrals, it seems that the area between \[0, 2] on the _x_-axis is to be calculated using the given function:

�(�)=(\[�3-5�2+4�+�])|06

To evaluate the integral at the given points, simply plug in the values as follows:

�(�)=(\[63-5(6)2+4(6)+�])-(\[03-5(0)2+4(0)+�])

�(�)=(\[216-180+24+�])-(\[0-0+0+�])

�(�)=(\[60+�])-(\[0+�])

�(�)=(60-0)

�(�)=60

**NOTE**

The constant _C_ will always cancel out in definite integrals so you can leave it out in this kind of problems.

Therefore, the area below the graph of _f(x)_ and above the _x_-axis, as well as between \[0, 6] on the _x_-axis, is equal to 60 square units. The following shows a few rules of thumb on integrals (after all, this chapter is supposed to refresh your knowledge or to give you a basic understanding of a few key mathematical concepts):

* To find the integral of a constant:

∫���=��+�

* To find the integral of a variable:

∫���=12�2+�

* To find the integral of a reciprocal:

∫1���=ln|�|+�

* To find the integral of an exponential:

∫����=��ln(�)+�

∫����=��+�

The _fundamental theorem of calculus_ links derivatives with integrals. This means that it defines derivatives in terms of integrals and vice versa. The fundamental theorem of calculus is actually made up of two parts:

Part IThe first part of the fundamental theorem of calculus states that if you have a continuous function _f(x)_, then the original function _F(x)_ defined as the antiderivative of _f(x)_ from a fixed starting point _a_ up to _x_, is a function that is differentiable everywhere from _a_ to _x_, and its derivative is simply _f(x)_ evaluated at _x_.Part IIThe second part of the fundamental theorem of calculus states that if you have a function _f(x)_ that is continuous over a certain interval \[_a, b_], and you define a new function _F(x)_ as the integral of _f(x)_ from _a_ to _x_, then the definite integral of _f(x)_ over that same interval \[_a, b_] can be calculated as _F(b) - F(a)_.

The theorem is useful in many fields including physics and engineering, but optimization and other mathematical models also benefit from it. Some examples of using integrals in the different learning algorithms can be summed up as follows:

Density estimationIntegrals are used in _density estimation_, a part of many machine learning algorithms, to calculate the probability density function.Reinforcement learningIntegrals are used in reinforcement learning to calculate expected values of reward functions. Reinforcement learning is covered in [Chapter 10](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch10.html#ch10).

**NOTE**

The key takeaways from this section are as follows:

* Integrals are also known as antiderivatives and they are the opposite of derivatives.
* Indefinite integrals find the area under the curve everywhere while definite integrals are bounded within an interval given by point _a_ and point _b_.
* The fundamental theorem of calculus is the bridge between derivatives and integrals.
* Integrals are used in machine learning for modeling uncertainty, making predictions, and estimating expected values.

### Optimization

Several machine and deep learning algorithms depend on optimization techniques to decrease error functions.

_Optimization_ is the process of finding the best solution among the possible solutions’ universe. Optimization is all about finding the highest and lowest points of a function. [Figure 4-17](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-17) shows the graph for the following formula:

�(�)=�4-2�2+�

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0417.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-17. The graph of the function**

A _local minimum_ exists when values on the right of the _x_-axis are decreasing until reaching a point where they start increasing. The point does not have to necessarily be the lowest point in the function, hence the name _local_. In [Figure 4-17](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-17), the function has a local minimum at point A.

A _local maximum_ exists when values on the right of the _x_-axis are increasing until reaching a point where they start decreasing. The point does not have to necessarily be the highest point in the function. In [Figure 4-17](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-17), the function has a local maximum at point B.

A _global minimum_ exists when values on the right of the _x_-axis are decreasing until reaching a point where they start increasing. The point must be the lowest point in the function hence the name global. In [Figure 4-17](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-17), the function has a global minimum at point C.

A _global maximum_ exists when values on the right of the _x_-axis are increasing until reaching a point where they start decreasing without. The point must be the highest point in the function. In [Figure 4-17](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-17), there is no global maximum, as the function will continue infinitely without shaping a top. You can clearly see how the function accelerates upwards.

When dealing with machine and deep learning models, the aim is to find model parameters (or inputs) that minimize what is known as a _loss function_ (a function that gives the error of forecasts). If the loss function is convex, optimization techniques should find the parameters that tend towards the global minimum where the loss function is minimized. Furthermore, if the loss function is non-convex, the convergence is not guaranteed, and the optimization may only lead towards approaching a local minimum, which is a part of the aim, but this leaves the global minimum which is the final aim.

But how are these minima and maxima found? Let’s look at it step by step:

1. The first step is to perform the first derivative test (which is simply calculating the derivative of the function). Then, setting the function equal to zero and solving for _x_ will give what is known as critical points. _Critical points_ are the points where the function changes direction (the values stop going in one direction and start going in another). Therefore, these points are maxima and minima.
2. The second step is to perform the second derivative test (which is simply calculating the derivative of the derivative). Then, setting the function equal to zero and solving for _x_ will give what is known as inflection points. _Inflection points_ give where the function is concave up and where it is concave down.

In other words, critical points are where the function changes direction and inflection points are where the function changes its concavity. [Figure 4-18](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#figure-4-18) shows the difference between a concave up function and a concave down function.

<figure><img src="https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781098148386/files/assets/dlff_0418.png" alt="" height="600" width="600"><figcaption></figcaption></figure>

**Figure 4-18. A concave up versus a concave down functions**

�����������������=�2

�������������������=-�2

The steps to find the extrema are as follows:

1. Find the first derivative and set it to zero.
2. Solve the first derivative to find _x_. The values are called critical points and they represent the points where the function changes the direction.
3. Plug in values in the formula that are either below or above the critical points. If the result of the first derivative is positive it means that it’s increasing around that point and if it’s negative, then it means that it’s decreasing around that point.
4. Find the second derivative and set it to zero.
5. Solve the second derivative to find _x_. The values, called inflection points, represent the points where concavity changes from up to down and vice versa.
6. Plug in values in the formula that are either below or above the inflection points. If the result of the second derivative is positive, it means there is a minimum at that point, and if it’s negative it means there is a maximum at that point.

It is important to understand that the first derivative and second derivative tests relate to critical points as opposed to the second derivative test relating to inflection points. The following example finds the extrema of the function:

�(�)=�2+�+4

The first step is to take the first derivative, set it to zero, and solve for _x_:

�'(�)=2�+1

2�+1=0

�=-12

Therefore, there is a critical point at that value. Now, the next step is to find the second derivative:

�''(�)=2

Next, the critical point must be plugged into the second derivative formula:

�''(-12)=2

The second derivative is positive at the critical point. This means that there is a local minimum at that point.

In the next chapters, you will see more complex optimization techniques such as the gradient descent and the stochastic gradient descent, which are fairly common in machine learning algorithms. Note that you do not have to fully understand the details of optimization and solving for the unknown variables as the algorithms will do that on their own.

**NOTE**

The key takeaways from this section are as follows:

* Optimization is the process of finding the function’s extrema.
* Critical points are the points where the function changes direction.&#x20;
* Inflection points give where the function is concave up and where it is concave down.
* A loss function is a function that measures the error of forecasts in predictive machine learning.

## Summary

Chapters [2](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch02.html#ch02), [3](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch03.html#ch03), and [4](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#ch04) have presented the main numerical concepts that you need to start understanding basic machine and deep learning models. I have made all reasonable efforts to simplify as much as possible the technical requirements, I do encourage you to read these three chapters at least twice so that everything you have learned becomes second nature. I also encourage you to look up these concepts in more depth in other material.

Naturally, deep learning requires more in-depth knowledge in mathematics, but I believe that with the concepts seen in this chapter, you may start dipping your toes in creating algorithms. After all, they come pre-built from packages and libraries, and the aim of this chapter is to understand what you are working with. It is unlikely that you will build the models from scratch using archaic tools.

By now, you should have gained a certain understanding of data science and the mathematical requirements that will get you started comfortably. You have two more steps to go before building your first machine learning model, technical analysis and Python skills.

[1](https://learning.oreilly.com/library/view/deep-learning-for/9781098148386/ch04.html#id243-marker) Matrices can also contain symbols and expressions but for the sake of simplicity, let’s stick to numbers.
